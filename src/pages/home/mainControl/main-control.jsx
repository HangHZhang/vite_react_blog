import React, { useState, useEffect } from "react";
import {
  Card,
  Typography,
  Divider,
  Grid,
  Skeleton,
  Link,
} from "@arco-design/web-react";
import { IconCaretUp } from "@arco-design/web-react/icon";
import {useSelector} from 'react-redux';

import MyContext from "../context.js";

import DiyIcon from "../../../components/Icon-DIY/index.jsx";
import MainControlLine from "../../../components/chart/main-control-line.jsx";
import storageUtils from "../../../utils/storageUtils.js";

import "./index.less";

const { Title, Paragraph } = Typography;
const { Row, Col } = Grid;

function StatisticItem(props) {
  const { icon, title, count, loading, unit } = props;
  return (
    <div className="item">
      <div className="icon">{icon}</div>
      <div>
        <Skeleton loading={loading} text={{ rows: 2, width: 60 }} animation>
          <div className="title">{title}</div>
          <div className="count">
            {count}
            <span className="unit">{unit}</span>
          </div>
        </Skeleton>
      </div>
    </div>
  );
}

const chartData = [
  { count: 52, date: "2022.07" },
  { count: 34, date: "2022.08" },
  { count: 27, date: "2022.09" },
  { count: 32, date: "2022.10" },
  { count: 25, date: "2022.11" },
  { count: 36, date: "2022.12" },
  { count: 69, date: "2023.01" },
  { count: 58, date: "2023.02" },
  { count: 35, date: "2023.03" },
  { count: 49, date: "2023.04" },
  { count: 31, date: "2023.05" },
  { count: 35, date: "2023.06" },
  { count: 52, date: "2023.07" },
  { count: 34, date: "2023.08" },
  { count: 32, date: "2023.09" },
  { count: 25, date: "2023.10" },
  { count: 24, date: "2023.11" },
  { count: 36, date: "2023.12" },
];

export default function MainControl() {
  const [loading, setLoading] = useState(true);

  const fetchData = () => {
    setLoading(true);
    setTimeout(() => {
      setLoading(false);
    }, 2000);
  };

  const user = useSelector(state => state.user)

  useEffect(() => {
    fetchData();
  }, []);

  return (
    <>
      <Card>
        <Title
          level={3}
          style={{
            fontSize: 20,
            lineHeight: 1.4,
            fontWeight: 500,
            color: "rgb(29,33,41)",
          }}
        >
          欢迎回来，{user.userInfo.username || '管理员'}
        </Title>
        <Divider />
        <Row align="center">
          <Col flex={1}>
            <StatisticItem
              icon={
                <DiyIcon
                  component={() => (
                    <svg
                      viewBox="0 0 1024 1024"
                      xmlns="http://www.w3.org/2000/svg"
                      width="24"
                      height="24"
                    >
                      <path
                        d="M942.6944 132.2752l-168.8832-10.6752v213.3248q-2.1504 224.5376 0 226.6624 2.1504 2.1504 0 0v377.088c0 10.6496 0 0-2.1504 8.5248-4.2752 21.3248-23.5008 36.2752-47.0272 36.2752H361.2672l523.6992 34.1248h6.4c44.9024 0 81.2288-34.1248 85.504-78.9248l47.0272-718.9504c2.1504-44.8-34.176-85.3248-81.2032-87.4496z"
                        fill="#DF4BFC"
                        p-id="1460"
                      ></path>
                      <path
                        d="M726.784 0H85.504C38.4768 0 0 38.4 0 85.3248v853.3504A85.6576 85.6576 0 0 0 85.504 1024h641.28c47.0272 0 85.504-38.4 85.504-85.3248V85.3248A85.6576 85.6576 0 0 0 726.784 0z m-205.2096 518.4H175.2832c-21.376 0-36.352-17.0752-36.352-36.2752 0-21.3248 17.1008-36.2496 36.352-36.2496h346.2912c21.376 0 36.352 17.0496 36.352 36.2496 0 19.2-17.1264 36.2752-36.352 36.2752zM175.2832 686.9248h247.9616c21.376 0 38.4768 17.0752 38.4768 38.4 0 21.3504-17.1008 38.4-38.4768 38.4H175.2832a38.272 38.272 0 0 1-38.4768-38.4c0-21.3248 17.1008-38.4 38.4768-38.4z"
                        fill="#B454FD"
                        p-id="1461"
                      ></path>
                    </svg>
                  )}
                />
              }
              title="博客文章数"
              count="100+"
              loading={loading}
              unit="个"
            />
          </Col>
          <Divider type="vertical" style={{ height: 70 }} />
          <Col flex={1}>
            <StatisticItem
              icon={
                <DiyIcon
                  component={() => (
                    <svg
                      viewBox="0 0 1024 1024"
                      xmlns="http://www.w3.org/2000/svg"
                      width="24"
                      height="24"
                    >
                      <path
                        d="M336.457143 336.457143m-336.457143 0a336.457143 336.457143 0 1 0 672.914286 0 336.457143 336.457143 0 1 0-672.914286 0Z"
                        fill="#8CF6FB"
                        p-id="9686"
                      ></path>
                      <path
                        d="M343.771429 468.114286h-219.428572C55.588571 468.114286 0 412.525714 0 343.771429v-219.428572C0 55.588571 55.588571 0 124.342857 0h219.428572C412.525714 0 468.114286 55.588571 468.114286 124.342857v219.428572c0 68.754286-55.588571 124.342857-124.342857 124.342857zM124.342857 73.142857C96.548571 73.142857 73.142857 96.548571 73.142857 124.342857v219.428572C73.142857 371.565714 96.548571 394.971429 124.342857 394.971429h219.428572c27.794286 0 51.2-23.405714 51.2-51.2v-219.428572C394.971429 96.548571 371.565714 73.142857 343.771429 73.142857h-219.428572z m775.314286 394.971429h-219.428572c-68.754286 0-124.342857-55.588571-124.342857-124.342857v-219.428572C555.885714 55.588571 611.474286 0 680.228571 0h219.428572C968.411429 0 1024 55.588571 1024 124.342857v219.428572c0 68.754286-55.588571 124.342857-124.342857 124.342857z m-219.428572-394.971429C652.434286 73.142857 629.028571 96.548571 629.028571 124.342857v219.428572c0 27.794286 23.405714 51.2 51.2 51.2h219.428572c27.794286 0 51.2-23.405714 51.2-51.2v-219.428572C950.857143 96.548571 927.451429 73.142857 899.657143 73.142857h-219.428572z m-336.457142 950.857143h-219.428572C55.588571 1024 0 968.411429 0 899.657143v-219.428572C0 611.474286 55.588571 555.885714 124.342857 555.885714h219.428572c68.754286 0 124.342857 55.588571 124.342857 124.342857v219.428572c0 68.754286-55.588571 124.342857-124.342857 124.342857z m-219.428572-394.971429C96.548571 629.028571 73.142857 652.434286 73.142857 680.228571v219.428572C73.142857 927.451429 96.548571 950.857143 124.342857 950.857143h219.428572c27.794286 0 51.2-23.405714 51.2-51.2v-219.428572c0-27.794286-23.405714-51.2-51.2-51.2h-219.428572z"
                        fill="#3C2DCB"
                        p-id="9687"
                      ></path>
                      <path
                        d="M789.942857 1024c-128.731429 0-234.057143-105.325714-234.057143-234.057143s105.325714-234.057143 234.057143-234.057143 234.057143 105.325714 234.057143 234.057143-105.325714 234.057143-234.057143 234.057143z m0-394.971429c-89.234286 0-160.914286 71.68-160.914286 160.914286s71.68 160.914286 160.914286 160.914286 160.914286-71.68 160.914286-160.914286-71.68-160.914286-160.914286-160.914286z"
                        fill="#D098FF"
                        p-id="9688"
                      ></path>
                    </svg>
                  )}
                />
              }
              title="文章分类数"
              count="10+"
              loading={loading}
              unit="个"
            />
          </Col>
          <Divider type="vertical" style={{ height: 70 }} />
          <Col flex={1}>
            <StatisticItem
              icon={
                <DiyIcon
                  component={() => (
                    <svg
                      viewBox="0 0 1024 1024"
                      xmlns="http://www.w3.org/2000/svg"
                      width="28"
                      height="28"
                    >
                      <path
                        d="M916.3264 819.712h-54.9888V381.184a30.3616 30.3616 0 0 0-30.3616-30.3616h-117.0944a30.3616 30.3616 0 0 0-30.3616 30.3616v438.528h-83.6608v-285.5424a30.3616 30.3616 0 0 0-30.3616-30.3616H452.4544a30.3616 30.3616 0 0 0-30.3616 30.3616v285.5424H341.8112v-128.768a30.3616 30.3616 0 0 0-30.3616-30.3616H194.3552a30.3616 30.3616 0 0 0-30.3616 30.3616v128.768H111.4112c-25.088 0-45.4656 20.3264-45.4656 45.4656s20.3264 45.4656 45.4656 45.4656h804.9152c25.088 0 45.4656-20.3264 45.4656-45.4656s-20.3264-45.4656-45.4656-45.4656z"
                        fill="#6C6CEA"
                        p-id="12535"
                      ></path>
                      <path
                        d="M183.3472 561.92c10.8544 0 21.7088-3.84 30.4128-11.6736L437.0944 349.184l64.6144 50.3808a45.40416 45.40416 0 0 0 58.8288-2.5088l161.9456-150.016v10.2912c0 25.088 20.3264 45.4656 45.4656 45.4656s45.4656-20.3264 45.4656-45.4656V135.68c0-25.088-20.3264-45.4656-45.4656-45.4656H641.536c-25.088 0-45.4656 20.3264-45.4656 45.4656s20.3264 45.4656 45.4656 45.4656h18.432L527.1552 304.128l-64.1536-50.0736a45.44512 45.44512 0 0 0-58.368 2.048L152.9344 482.7136a45.48608 45.48608 0 0 0-3.3792 64.2048 45.54752 45.54752 0 0 0 33.792 15.0016zM861.3888 597.248v-216.064a30.3616 30.3616 0 0 0-30.3616-30.3616h-117.0944a30.3616 30.3616 0 0 0-30.3616 30.3616v438.528h-83.6608v-285.5424a30.3616 30.3616 0 0 0-30.3616-30.3616H452.4544a30.3616 30.3616 0 0 0-30.3616 30.3616v285.5424H341.8112v-128.768a30.3616 30.3616 0 0 0-30.3616-30.3616H194.3552a30.3616 30.3616 0 0 0-30.3616 30.3616v128.768H111.4112c-25.088 0-45.4656 20.3264-45.4656 45.4656s20.3264 45.4656 45.4656 45.4656h506.7264c113.152-73.0624 199.9872-183.2448 243.2512-313.3952z"
                        fill="#757BF2"
                        p-id="12536"
                      ></path>
                      <path
                        d="M596.0704 135.68c0 25.088 20.3264 45.4656 45.4656 45.4656h18.432L527.1552 304.128l-64.1536-50.0736a45.44512 45.44512 0 0 0-58.368 2.048L152.9344 482.7136a45.48608 45.48608 0 0 0-3.3792 64.2048 45.25568 45.25568 0 0 0 33.792 15.0528c10.8544 0 21.7088-3.84 30.4128-11.6736L437.0944 349.184l64.6144 50.3808a45.40416 45.40416 0 0 0 58.8288-2.5088l161.9456-150.016v10.2912c0 4.1472 0.6144 8.1408 1.6384 11.9808 2.8672-23.7056 4.5056-47.8208 4.5056-72.2944 0-36.5056-3.4304-72.1408-9.728-106.8544h-77.4144c-25.088 0.0512-45.4144 20.4288-45.4144 45.5168zM708.352 351.4368c-14.1312 2.6112-24.832 14.9504-24.832 29.7984v43.52c9.8304-23.7568 18.1248-48.2304 24.832-73.3184zM422.0928 534.1696v184.2688a600.2176 600.2176 0 0 0 177.8176-151.3984v-32.8704a30.3616 30.3616 0 0 0-30.3616-30.3616H452.4544a30.3616 30.3616 0 0 0-30.3616 30.3616zM341.8112 755.712v-64.768a30.3616 30.3616 0 0 0-30.3616-30.3616H194.3552a30.3616 30.3616 0 0 0-30.3616 30.3616v101.9392a592.5888 592.5888 0 0 0 177.8176-37.1712z"
                        fill="#8486F8"
                        p-id="12537"
                      ></path>
                      <path
                        d="M462.9504 254.0544a45.44512 45.44512 0 0 0-58.368 2.048L152.9344 482.7136a45.48608 45.48608 0 0 0-3.3792 64.2048 45.25568 45.25568 0 0 0 33.792 15.0528c10.8544 0 21.7088-3.84 30.4128-11.6736L437.0944 349.184l21.9136 17.1008c18.2784-24.2688 34.6624-50.0224 49.1008-76.9536l-45.1584-35.2768z"
                        fill="#8D92F8"
                        p-id="12538"
                      ></path>
                    </svg>
                  )}
                />
              }
              title="新增文章数"
              count={
                <span>
                  {"2.8%"}{" "}
                  <IconCaretUp style={{ fontSize: 18, color: "#4779A9" }} />
                </span>
              }
              loading={loading}
            />
          </Col>
          <Divider type="vertical" style={{ height: 70 }} />
          <Col flex={1}>
            <StatisticItem
              icon={
                <DiyIcon
                  component={() => (
                    <svg
                      viewBox="0 0 1024 1024"
                      xmlns="http://www.w3.org/2000/svg"
                      width="28"
                      height="28"
                    >
                      <path
                        d="M1023.910943 511.999898c5.11911 317.794367-194.116663 516.825376-511.91103 511.911029-317.794367 4.914346-516.825376-194.116663-511.91103-511.911029C-4.825463 194.20553 194.205546-4.825478 511.999913 0.088868c317.794367-4.914346 516.825376 194.116663 511.91103 511.91103z"
                        fill="#FF5FB7"
                        p-id="21456"
                      ></path>
                      <path
                        d="M1022.477592 566.671996C1006.915497 340.40732 852.318366 201.16752 614.382119 204.85328c-254.112635-4.095288-413.624112 155.416189-409.528824 409.528824-3.890524 237.936247 135.554041 392.533378 361.613952 408.095473 268.036615-16.381153 439.629192-187.97373 456.010345-455.805581z"
                        fill="#FF55AA"
                        p-id="21457"
                      ></path>
                      <path
                        d="M1015.515602 629.944199C985.824762 491.523456 876.480566 407.160519 716.764325 409.617692c-190.635668-3.071466-310.218084 116.51095-307.146618 307.146618-2.457173 159.716241 81.905765 269.060437 220.121743 298.751277 211.112109-34.400421 351.375731-174.664043 385.776152-385.571388z"
                        fill="#FF4A9C"
                        p-id="21458"
                      ></path>
                      <path
                        d="M997.701098 705.707031C964.734028 646.734881 902.076118 613.153517 819.146531 614.382104c-127.1587-2.047644-206.812056 77.605712-204.764412 204.764412-1.433351 82.929587 32.352777 145.587497 91.120163 178.554567a431.233852 431.233852 0 0 0 292.198816-291.994052z"
                        fill="#FF408E"
                        p-id="21459"
                      ></path>
                      <path
                        d="M273.654138 828.360914L778.193649 634.858545H245.806178v174.868808a20.476441 20.476441 0 0 0 27.84796 18.633561z"
                        fill="#FFFFFF"
                        p-id="21460"
                      ></path>
                      <path
                        d="M750.345689 828.360914L245.806178 634.858545V255.634854a61.429324 61.429324 0 0 1 61.429323-61.429324h409.528824a61.429324 61.429324 0 0 1 61.429324 61.429324v552.863912a20.476441 20.476441 0 0 1-27.84796 19.862148z"
                        fill="#FFB0E3"
                        p-id="21461"
                      ></path>
                      <path
                        d="M368.664825 276.111295m30.714661 0l225.240854 0q30.714662 0 30.714661 30.714662l0 0q0 30.714662-30.714661 30.714662l-225.240854 0q-30.714662 0-30.714661-30.714662l0 0q0-30.714662 30.714661-30.714662Z"
                        fill="#FFFFFF"
                        p-id="21462"
                      ></path>
                    </svg>
                  )}
                />
              }
              title="标签数"
              count="10+"
              loading={loading}
              unit="个"
            />
          </Col>
        </Row>
        <Divider />
        <div>
          <div className="ctw">
            <Paragraph className="chart-title" style={{ marginBottom: 0 }}>
              文章数
            </Paragraph>
            <Link type="primary">查看更多</Link>
          </div>
          <MainControlLine data={chartData} loading={loading} />
        </div>
      </Card>
    </>
  );
}